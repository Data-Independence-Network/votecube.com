<aside>
    <nav
        on:click="fire('close')"
    >
        x
    </nav>
    <div></div>
    <section>
    <table>
        <!-- TODO: add support for voting value -->
        <LinearPositionPicker
            dimension="{getDimension(poll, 0)}"
            value="{getDisplayValue(poll, 0)}"
            on:move="move('x', event.direction, event.percentChange)"
            on:moveToValue="moveToValue('x', event)"
            on:update="update()"
            ref:xPicker
        />
        <LinearPositionPicker
            dimension="{getDimension(poll, 1)}"
            value="{getDisplayValue(poll, 1)}"
            on:move="move('y', event.direction, event.percentChange)"
            on:moveToValue="moveToValue('y', event)"
            on:update="update()"
            ref:yPicker
        />
        <LinearPositionPicker
            dimension="{getDimension(poll, 2)}"
            value="{getDisplayValue(poll, 2)}"
            on:move="move('z', event.direction, event.percentChange)"
            on:moveToValue="moveToValue('z', event)"
            on:update="update()"
            ref:zPicker
        />
    </table>
    </section>
</aside>

<style>
    aside {
        background: transparent;
        bottom: 0px;
        color: black;
        margin: 0px;
        padding: 3px;
        position: fixed;
    }
    div {
        border-top: 2px dashed black;
        margin-left: 50px;
        position: relative;
        top: 0px;
        width: calc(100% - 53px);
    }
    nav {
        background: hsla( 0, 100%, 100%, 0.8);
        border: 2px dashed black;
        border-bottom: 0px;
        border-top-left-radius: 3px;
        border-top-right-radius: 3px;
        color: black;
        font-size: 2em;
        height: 45px;
        text-align: center;
        vertical-align: middle;
        width: 50px;
    }
    section {
        background: hsla(  0, 100%, 100%, 0.8);
        border: 2px dashed black;
        border-top: 0px;
        font-size: 3em;
        text-align: center;
        width: 100%;
    }
</style>


<script>
import LinearPositionPicker from './LinearPositionPicker.html'
import {getDimension, getDisplayValue} from '../../helpers/cube';
import store from '../../store.js';

export default {
    components: {
        LinearPositionPicker
    },
	helpers: {
		getDimension,
		getDisplayValue
	},
    methods: {
        move(
            dimension,
            direction,
            percentChange
        ) {
            this.fire('move', {
                dimension,
                direction,
                percentChange
            })
        },
        moveToValue(
            dimension,
            value
        ) {
            this.fire('moveToValue', {
                dimension,
                value
            })
            refresh(this)
        },
        update() {
            refresh(this)
        }
    },
    store: () => store
}

function refresh(
    page
) {
    page.refs.xPicker.fire('refresh')
    page.refs.yPicker.fire('refresh')
    page.refs.zPicker.fire('refresh')
}

</script>