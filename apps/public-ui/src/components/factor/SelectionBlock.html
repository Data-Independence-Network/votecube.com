<Block
		customError="{text.error}"
		fieldGroup="{factor}"
		on:select="fire('select')"
>
	<div slot="content">
		<table>
			<tr>
				<td>
					<div>
						<figure
								class="colorSelection centered"
								style="
                    background-color: {selectedColor}
                "
						>
						</figure>
					</div>
				</td>
				<td>
					{#if factor.valid && factor.hasChildValues}
					{factor.fields.name.value}
					{:else}
					{text.label}
					{/if}
				</td>
			</tr>
		</table>
		<section>
			<div>
				<CharacterButton
						character="A"
						fontSize="20"
						fontX="12"
						fontY="19"
						size="24"
						strokeWidth="1"
				></CharacterButton>
				<div>
					{#if factor.valid && factor.hasChildValues}
					{factor.fields.positions.fields.A.value}
					{/if}
				</div>
			</div>
			<div>
				<CharacterButton
						character="B"
						fontSize="20"
						fontX="12"
						fontY="19"
						size="24"
						strokeWidth="1"
				></CharacterButton>
				<div>
					{#if factor.valid && factor.hasChildValues}
					{factor.fields.positions.fields.B.value}
					{/if}
				</div>
			</div>
		</section>
	</div>
</Block>

<style>

	section {
		display: flex;
		margin-top: 10px;
		width: 100%;
	}

	section > div {
		flex-basis: 100%;
		text-align: center;
		word-break: break-word;
	}

	td > div {
		position: relative;
		min-height: 55px;
	}

	td:first-child {
		width: 55px;
	}

	td:nth-child(2) {
		padding-left: 5px;
		width: calc(100% - 56px);
	}

</style>

<script>
	import CharacterButton from '../../common/control/button/CharacterButton.html'
	import Block           from '../../common/field/Block.html'

	export default {
		components: {
			Block,
			CharacterButton,
		},
		computed: {
			color: ({factor}) => factor
				? factor.fields.color
				: null,
			selectedColor: ({color}) => {
				if (!color || !color.valid) {
					return '#808080'
				}
				const value = color.value

				return `rgb(${value.red}, ${value.green}, ${value.blue})`
			},
			submitHighlight: ({isValid}) => isValid
				? '0b0'
				: 'b00'
		},
	}
</script>