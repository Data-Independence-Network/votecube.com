<div>
<nav
        style="
      margin-top: 25px;
      "
    >
        <ZoomPicker
            currentZoom="{currentZoom}"
            on:zoomChange="zoomChange(event)"
        />
        <table
                style="
                width: 100%;
                font-size: 3em;
                text-align: center;
            ">
            <tr>
                <td>
                    -
                </td>
                <td>
                    %
                </td>
                <td>
                    +
                </td>
            </tr>
            <LinearPositionPicker
                dimension="{$currentValue.x}"
                on:move="move('x', event)"
                on:moveToValue="moveToValue('x', event)"
            />
            <tr>
                <td colspan="3">
                <section>
                    {xText}
                </section>
                </td>
            </tr>
            <LinearPositionPicker
                dimension="{$currentValue.y}"
                on:move="move('y', event)"
                on:moveToValue="moveToValue('y', event)"
            />
            <tr>
                <td colspan="3">
                <section>
                    {yText}
                </section>
                </td>
            </tr>
            <LinearPositionPicker
                dimension="{$currentValue.z}"
                on:move="move('z', event)"
                on:moveToValue="moveToValue('z', event)"
            />
            <tr>
                <td colspan="3">
                <section>
                    {zText}
                </section>
                </td>
            </tr>
        </table>
    </nav>
</div>

<style>
section {
    font-size: 0.5em;
    margin-bottom: 20px;
}
</style>

<script>
    import LinearPositionPicker from '../../common/control/LinearPositionPicker.html'
    import ZoomPicker from '../../common/control/ZoomPicker.html'
	import store from '../../store.js';

    export default {
        components: {
            LinearPositionPicker,
            ZoomPicker
        },
        computed: {
            xText: ({$currentValue, $text}) => $currentValue.x.dir === 1 ? $text[0] : $text[5],
            yText: ({$currentValue, $text}) => $currentValue.y.dir === 1 ? $text[1] : $text[3],
            zText: ({$currentValue, $text}) => $currentValue.z.dir === 1 ? $text[2] : $text[4]
        },
        data() {
            return {
                currentZoom: 1
            }
        },
        methods: {
            zoomChange(event) {
                let currentZoom = parseInt(event.target.value)
                this.set({currentZoom})
                this.get().mutationApi.changeZoom(currentZoom)
            },
            move(
                dimension,
                direction
            ) {
                this.get().mutationApi.move(dimension, direction)
            },
            moveToValue(
                dimension,
                value
            ) {
                this.get().mutationApi.moveToValue(dimension, value)
            }
        },
        oncreate() {
            import('@votecube/cube-logic/lib/cube/eventListener').then((
                eventListener
            ) => {
            this.setCubeViewPort = (
                data,
                setMutationApi,
                callback
            ) => {
                setMutationApi(eventListener.setViewPort(
                    false, data, callback))
            }
            this.setCubeViewPort(
                this.store.get().currentValue,
                (
                    mutationApi
                ) => {
                    this.set({mutationApi})
                },
                (
                    currentValue
                ) => {
                    this.store.set({currentValue})
                },
            )
            })

        },
        ondestroy() {
            console.log('in TextVote ondestroy');
            this.setCubeViewPort(
                null,
                (
                    mutationApi
                ) => {
                    this.set({mutationApi})
                }
            )
        },
        store: () => store
    }
</script>
