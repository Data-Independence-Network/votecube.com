{#if form}
<form class="pure-form pure-form-aligned">
    <fieldset>
        <div class="pure-control-group">
            <DatePicker
                field="{form.fields.startDate}"
            ></DatePicker>
        </div>
        <div class="pure-control-group">
            <DatePicker
                field="{form.fields.endDate}"
            ></DatePicker>
        </div>
        <div class="pure-controls">
            <RightButton
                classes="submitButton"
                highlightColor="{submitHighlight}"
            ></RightButton>
        </div>
    </fieldset>
</form>
{/if}

<script>
import RightButton from '../../../common/control/button/RightButton.html'
import DatePicker from '../../../common/field/DatePicker.html'
import {loadForms} from '../../../libs/forms'
import {loadUi} from '../../../libs/text/ui'
import store from '../../../store'

export default {
    components: {
        DatePicker,
        RightButton
    },
    computed: {
        submitHighlight: ({isValid}) => isValid
        ? '0b0'
        : 'b00'
    },
    immutable: true,
    oncreate() {
        Promise.all([
            loadForms(this),
            loadUi(this.store, 'en-us')
        ]).then(([
            {DateField, FieldGroup, Validators},
            _
        ]) => {
            const text = this.store.get().text
            const startDate = new DateField([
                    Validators.required(),
                    Validators.minTomorrow()
                ])
            const form = new FieldGroup('Dates', {
                startDate,
                endDate: new DateField([
                    Validators.required(),
                    Validators.minTomorrow(),
                    Validators.greaterThanOrEquals(startDate)
                ]),
            }, [], this, text.UI.Poll.Create)
            this.set({form})
        })
    },
    store: () => store
}
</script>