<!--
<div
		class="parentContainer"
></div>
-->
<div
		class="details {classes}"
		on:click="fire('select', {event})"
>
	{#if showLink}
	<LinkIcon
			styles="left: 5px; position: absolute; top: 10px;"
	></LinkIcon>
	{:elseif showTarget}
	<TargetIcon
			styles="left: 13px; position: absolute; top: 3px;"
	></TargetIcon>
	{/if}
	<div
			class="icon"
	>
		<figure>
			<div
					class="surface s1"
					style="
        background-color: #{getColor(0, variation, 'x')};
                        "
			></div>
			<div
					class="surface s2"
					style="
        background-color: #{getColor(0, variation, 'z')};
                        "
			></div>
			<div
					class="surface s5"
					style="
        background-color: #{getColor(0, variation, 'y')};
                        "
			></div>
		</figure>
	</div>
	<div
			class="description"
	>
		<div
				class="pollName"
				class:outcomes="mode === 'outcomes'"
		>
			{variation.name}
		</div>

		{#if mode === 'factors'}
		<var>
			{getSideText(delta, 'confirm', variation, 'x', 1)}
		</var>
		<var>
			{getSideText(delta, 'confirm', variation, 'y', 1)}
		</var>
		<var>
			{getSideText(delta, 'confirm', variation, 'z', 1)}
		</var>
		{:else}

		<section>
			<var
					class="A"
			>
				{sortedOutcomes[0].outcome}
			</var>
			<var
					class="B"
			>
				{sortedOutcomes[1].outcome}
			</var>
		</section>
		{/if}
	</div>
</div>
{#if childMode}
<nav
		class="{classes}"
>
	<RightButton
			on:select="fire('moveDownHierarchy')"
			size="25"
			styles="transform: rotate(90deg);"
	></RightButton>
</nav>
{/if}
<style>
	figure {
		border-radius: 3px;
		height: 21px;
		margin: auto;
		position: relative;
		transform: rotateX(-45deg) rotateY(45deg);
		transform-style: preserve-3d;
		width: 21px;
	}

	section {
		display: flex;
		text-align: center;
		width: 100%;
	}

	section > var {
		flex-basis: 100%;
	}

	section > var:first-child {
		padding-right: 5px;
	}

	section > var:last-child {
		padding-left: 5px;
	}


	div > var {
		display: block;
		padding-left: 15px;
	}

	nav {
		text-align: center;
		transition: height 3s;
	}

	nav.closed {
		height: 0px;
		overflow: hidden;
	}

	nav.closing {
		height: 25px;
		overflow: hidden;
	}

	.description {
		padding: 9px;
		flex-grow: 1; /* Set the middle element to grow and stretch */
	}

	.details {
		align-items: center;
		display: flex;
		position: relative;
		transition: height 1s;
	}

	.details.closed {
		height: 0px;
		overflow: hidden;
	}

	.details.closing {
		height: 100px;
		overflow: hidden;
	}

	.icon {
		perspective: 350px;
		perspective-origin: 50% 80px;
		width: 45px;
	}

	.pollName {
		color: black;
		font-weight: 500;
		overflow: hidden;
	}

	.outcomes {
		text-align: center;
	}

	.s1 {
		transform: rotateX(90deg) translateZ(12px)
	}

	.s2 {
		transform: translateZ(12px)
	}

	.s5 {
		transform: rotateY(90deg) translateZ(-12px)
	}

	.surface {
		position: absolute;
		height: 22.5px;
		width: 22.5px;
		border-radius: 3px;
		border: 2px groove gray;
	}
</style>
<script>
	import RightButton from '../../../common/control/button/RightButton.html'
	import LinkIcon    from '../../../common/icon/LinkIcon.html'
	import TargetIcon  from '../../../common/icon/TargetIcon.html'
	import {
		getColor,
		getSideText
	}                  from '../../../helpers/cube'

	export default {
		components: {
			LinkIcon,
			RightButton,
			TargetIcon
		},
		computed: {
			showLink: ({navList, variation}) =>
				variation.id === navList.variation.id
				&& !navList.isTarget,
			showTarget: ({navList, variation}) =>
				variation.id === navList.variation.id
				&& navList.isTarget,
			sortedOutcomes: ({variation}) => {
				const sortedOutcomes = variation.outcomes.sort((
					outcome1,
					outcome2
				) => outcome1.key > outcome2.key)

				return sortedOutcomes
			}
		},
		data: () => ({
			childMode: true,
			classes: ''
		}),
		helpers: {
			getColor,
			getSideText
		},
		immutable: true
	}

</script>