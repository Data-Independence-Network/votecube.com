{#if form}
<form class="pure-form">
    <fieldset>
        <div class="pure-control-group">
            <AutoComplete
                field="{form.fields.theme}"
            ></AutoComplete>
        </div>
        <div class="pure-control-group">
            <MultiSelect
                field="{form.fields.labels}"
            ></MultiSelect>
        </div>
    </fieldset>
</form>
<table>
    {#each dimensions as dimension}
    <ListItem
        dimension="{dimension}"
    ></ListItem>
    {/each}
</table>
<!--
<VirtualList items={dimensions} component={ListItem} />
-->
{/if}

<style>
    table {
        width: 100%;
    }
</style>
<script>
// import VirtualList from '@sveltejs/svelte-virtual-list';
import AutoComplete from '../../common/field/AutoComplete.html'
import MultiSelect from '../../common/field/MultiSelect.html'
import {dimensionDao} from '../../dao/dimension'
import {clearForm, ensureForm, navigateOnValid} from '../../forms'
import {loadForms} from '../../libs/forms'
import {loadUi} from '../../libs/text/ui'
import {SELECT_POLL_DIMENSIONS} from '../../routes'
import store from '../../store'
import ListItem from './ListItem.html';

export default {
    components: {
        AutoComplete,
        ListItem,
        MultiSelect,
        // VirtualList
    },
    // data() {
    //   return {
    //     ListItem
    //   }
    // },
    methods: {
        submit() {
            navigateOnValid(this, SELECT_POLL_DIMENSIONS)
        }
    },
    oncreate() {
        Promise.all([
            loadForms(this),
            loadUi(this.store, 'en-us'),
            dimensionDao.getAll()
        ]).then(([
            {FieldGroup, OptionsField, Validators},
            _,
            dimensions
        ]) => {
            const filter = new FieldGroup('List', {
            theme: new OptionsField([
                // Validators.required()
            ], [{
                id: 1,
                text: 'Politics'
            },{
                id: 2,
                text: 'Culture'
            },{
                id: 3,
                text: 'Technology'
            },{
                id: 4,
                text: 'Space'
            },{
                id: 5,
                text: 'Security'
            }]),
            labels: new OptionsField([], [{
                id: 1,
                text: 'Trump',
                theme: {
                    id: 1
                }
            },{
                id: 2,
                text: 'Integration',
                theme: {
                    id: 1
                }
            }], {
                multi: true
            })
            }, [], this.store.get().text.UI.Dimension)

            this.set({dimensions})
            ensureForm(filter, this)
        })
    },
    ondestroy() {
        clearForm(this)
    },
    store: () => store
}
</script>