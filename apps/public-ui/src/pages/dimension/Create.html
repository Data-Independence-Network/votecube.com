{#if form}
<form class="pure-form">
    <fieldset>
        <div class="pure-control-group">
            <Text
                field="{form.fields.name}"
            ></Text>
        </div>

        <IconBlock
            fieldGroup="{form.fields.color}"
            on:select="selectColor()"
        >
            <div slot="icon">
                <ColorIcon></ColorIcon>
            </div>
            <div
                class:selected="color.valid"
                slot="text"
                style="
                    background-color: {selectedColor};
                "
                >
    {#if !color.valid}
        Select Color
    {/if}
            </div>
        </IconBlock>

        <IconBlock
            fieldGroup="{form.fields.topDirection}"
            on:select="selectDirection('top')"
        >
            <div slot="icon">
                <DirectionIcon></DirectionIcon>
            </div>
            <div slot="text">
    {#if topDirection.valid}
                {topDirection.fields.name.value}
    {:else}
                Select Top Direction
    {/if}
            </div>
        </IconBlock>

        <IconBlock
            fieldGroup="{form.fields.bottomDirection}"
            on:select="selectDirection('bottom')"
        >
            <div slot="icon">
                <DirectionIcon
                    inverse="Y"
                ></DirectionIcon>
            </div>
            <div slot="text">
    {#if bottomDirection.valid}
                {bottomDirection.fields.name.value}
    {:else}
                Select Bottom Direction
    {/if}
            </div>
        </IconBlock>

        <nav class="pure-controls">
            <RightButton
                classes="submitButton"
                highlightColor="{submitHighlight}"
            ></RightButton>
        </nav>
    </fieldset>
</form>
{/if}

<style>
    .selected {
        border: 3px groove gray;
        border-radius: 3px;
        height: 45px;
        width: 45px;
    }
</style>

<script>
import RightButton from '../../common/control/button/RightButton.html'
import IconBlock from '../../common/field/IconBlock.html'
import Text from '../../common/field/Text.html'
import ColorIcon from '../../common/icon/ColorIcon.html'
import DirectionIcon from '../../common/icon/DirectionIcon.html'
import * as forms from '../../forms'
import * as routes from '../../routes'
import store from '../../store'

export default {
    components: {
        ColorIcon,
        DirectionIcon,
        IconBlock,
        RightButton,
        Text
    },
    computed: {
        bottomDirection: ({form}) => form
            ? form.fields.bottomDirection
            : null,
        color: ({form}) => form
            ? form.fields.color
            : null,
        selectedColor: ({color}) => {
            if(!color || !color.valid) {
                return 'initial'
            }
            const value = color.value.picker

            return `rgb(${value.red}, ${value.green}, ${value.blue})`
        },
        submitHighlight: ({isValid}) => isValid
        ? '0b0'
        : 'b00',
        topDirection: ({form}) => form
            ? form.fields.topDirection
            : null
    },
    methods: {
        selectColor() {
            routes.navigateToPage(routes.PICK_DIMENSION_COLOR, )
        },
        selectDirection(
            directionPrefix
        ) {
            const dimensionForm = this.get().form
            forms.setForm(forms.CREATE_DIRECTION, dimensionForm.fields[directionPrefix + 'Direction'])
            routes.navigateToPage(routes.CREATE_DIRECTION, {
                directionPrefix
            })
        }
    },
    oncreate() {
        forms.ensureTopForm(
            forms.CREATE_DIMENSION,
            this, routes.CREATE_POLL_NAME_LOC_DATE)
    },
    ondestroy() {
        forms.clearForm(this)
    },
    store: () => store
}
</script>