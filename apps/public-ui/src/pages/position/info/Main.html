{#if form}
<form>
	<div class="pure-control-group">
            <TextArea
				            field="{form.fields.name}"
            ></TextArea>
	</div>

	<nav class="pure-controls">
		<RightButton
						classes="submitButton"
						highlightColor="{submitHighlight}"
						on:select="select($routeParams)"
		></RightButton>
	</nav>
</form>
{/if}

<style>
</style>

<script>
	import RightButton    from '../../../common/control/button/RightButton.html'
	import TextArea       from '../../../common/field/TextArea.html'
	import * as formCache from '@votecube/public-logic/src/form/cache'
	import * as forms     from '@votecube/public-logic/src/form/forms'
	import * as routes    from '../../../routes'
	import store          from '../../../store'

	export default {
		components: {
			RightButton,
			TextArea
		},
		computed: {
			submitHighlight: ({isValid}) => isValid
				? '0b0'
				: 'b00'
		},
		methods: {
			select(
				$routeParams
			) {
				this.set({keepPollId: $routeParams.pollId})
				forms.navigateOnValid(this, routes.FACTOR_INFO_MAIN, $routeParams)
			}
		},
		oncreate() {
			formCache.getPollRouteParams(this)
			forms.ensureTopForm(
				forms.CREATE_POSITION,
				this, routes.POLL_INFO_MAIN)
			this.store.set({
				pageTitle: 'Position Info'
			})
		},
		ondestroy() {
			formCache.savePollForm(this).then()
			forms.clearForm(this)
		},
		store: () => store
	}
</script>
