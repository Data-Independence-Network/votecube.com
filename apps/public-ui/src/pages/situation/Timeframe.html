{#if form}
<form>
	<div class="pure-control-group">
		<DatePicker
						field="{form.fields.startDate}"
		></DatePicker>
	</div>
	<div class="pure-control-group">
		<DatePicker
						field="{form.fields.endDate}"
		></DatePicker>
	</div>
	<div class="pure-controls">
		<RightButton
						classes="submitButton"
						highlightColor="{submitHighlight}"
						on:select="submit($routeParams)"
		></RightButton>
	</div>
</form>
{/if}

<script>
	import RightButton    from '@votecube/ui-controls/src/button/RightButton.svelte'
	import DatePicker     from '@votecube/ui-controls/src/field/DatePicker.html'
	import * as formCache from '../../form/cache'
	import * as forms     from '../../form/forms'
	import * as routes    from '@votecube/vc-logic/src/routes'
	import store          from '@votecube/ui-logic'

	export default {
		components: {
			DatePicker,
			RightButton
		},
		computed: {
			submitHighlight: ({isValid}) => isValid
				? '0b0'
				: 'b00'
		},
		immutable: true,
		methods: {
			submit(
				$routeParams
			) {
				// this.set({keepRepositoryUuId: $routeParams.repositoryUuId})
				forms.navigateOnValid(this, routes.SITUATION_FORM, $routeParams)
			}
		},
		oncreate() {
			formCache.getSituationRouteParams(this)
			forms.ensureChildForm(
				forms.DEFINE_SITUATION_TOP, 'timeframe',
				this, routes.SITUATION_FORM)
			this.store.set({
				pageTitle: 'Situation Time Frame'
			})
		},
		ondestroy() {
			formCache.saveSituationForm(this).then()
			forms.clearForm(this)
		},
		store: () => store
	}
</script>
