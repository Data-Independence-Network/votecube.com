{#if form}
<form>
	<div class="pure-control-group">
		<ColorPicker
						field="{form.fields.picker}"
		></ColorPicker>
	</div>

	<nav class="pure-controls">
		<RightButton
						classes="submitButton"
						highlightColor="{submitHighlight}"
						on:select="select($routeParams)"
		></RightButton>
	</nav>
</form>
{/if}
<script>
	import RightButton    from '../../common/control/button/RightButton.html'
	import ColorPicker    from '../../common/field/ColorPicker.html'
	import * as formCache from '@votecube/public-logic/src/form/cache'
	import * as forms     from '@votecube/public-logic/src/form/forms'
	import * as routes    from '../../routes'
	import store          from '../../store'

	export default {
		components: {
			ColorPicker,
			RightButton
		},
		computed: {
			submitHighlight: ({isValid}) => isValid
				? '0b0'
				: 'b00'
		},
		methods: {
			select($routeParams) {
				this.set({keepPollId: $routeParams.pollId})
				forms.navigateOnValid(this, routes.FACTOR_INFO_MAIN, $routeParams)
			}
		},
		oncreate() {
			formCache.getPollRouteParams(this)
			forms.ensureChildForm(
				forms.CREATE_FACTOR, 'color',
				this, routes.POLL_INFO_MAIN
			)
			this.store.set({
				pageTitle: 'Select Factor Color'
			})
		},
		ondestroy() {
			formCache.savePollForm(this).then()
			forms.clearForm(this)
		},
		store: () => store
	}
</script>
