{#if form}
<form>
	<div class="pure-control-group">
		<Text
				field="{form.fields.name}"
		></Text>
	</div>
	<div
			class="positions"
	>
		<div
				class="A"
		>
			<CharacterButton
					character="A"
					fontSize="20"
					fontX="12"
					fontY="19"
					size="24"
					strokeWidth="1"
			></CharacterButton>
			<TextArea
					field="{form.fields.positions.fields.A}"
					mid="{true}"
			></TextArea>
		</div>
		<div
				class="B"
		>
			<CharacterButton
					character="B"
					fontSize="20"
					fontX="12"
					fontY="19"
					size="24"
					strokeWidth="1"
			></CharacterButton>
			<TextArea
					field="{form.fields.positions.fields.B}"
					mid="{true}"
			></TextArea>
		</div>
	</div>
	<div class="pure-control-group">
		<ColorPicker
				field="{form.fields.color}"
		></ColorPicker>
	</div>

	<nav class="pure-controls">
		<SaveButton
				classes="submitButton"
				highlightColor="{submitHighlight}"
				on:select="select($routeParams)"
		></SaveButton>
	</nav>
</form>
{/if}
<style>


	.A, .B {
		flex-basis: 100%;
		text-align: center;
	}

	.B {
		margin-left: 0.4em;
	}

	.positions {
		display: flex;
		margin-top: 10px;
		width: 100%;
	}
</style>
<script>
	import CharacterButton from '../../../common/control/button/CharacterButton.html'
	import SaveButton      from '../../../common/control/button/SaveButton.html'
	import ColorPicker     from '../../../common/field/ColorPicker.html'
	import Text            from '../../../common/field/Text.html'
	import TextArea        from '../../../common/field/TextArea.html'
	import PositionIcon    from '../../../common/icon/PositionIcon.html'
	import * as formCache  from '../../../form/cache'
	import * as forms      from '../../../form/forms'
	import * as routes     from '../../../routes'
	import store           from '../../../store'

	export default {
		components: {
			CharacterButton,
			ColorPicker,
			PositionIcon,
			SaveButton,
			Text,
			TextArea
		},
		computed: {
			color: ({form}) => form
				? form.fields.color
				: null,
			submitHighlight: ({isValid}) => isValid
				? '0b0'
				: 'b00'
		},
		methods: {
			select($routeParams) {
				this.set({keepPollId: $routeParams.pollId})
				forms.navigateOnValid(this, routes.POLL_INFO_MAIN, $routeParams)
			},
		},
		oncreate() {
			formCache.getPollRouteParams(this)
			forms.ensureTopForm(
				forms.CREATE_FACTOR,
				this, routes.POLL_INFO_MAIN)
			this.store.set({
				pageTitle: 'Factor Info'
			})
		},
		ondestroy() {
			formCache.savePollForm(this).then()
			forms.clearForm(this)
		},
		store: () => store
	}
</script>
